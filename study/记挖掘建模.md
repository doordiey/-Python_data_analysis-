## 记>挖掘建模

### 笔记

### 分类与预测

分类和预测...顾名思义。。

##### ①实现过程

构造分类模型得到分类规则以此分类、建立变量之间的函数模型以此进行预测或控制。

##### ②常用的分类与预测算法

回归分析（根据变量间的关系用于预测）、决策树（用于分类）、人工神经网络、贝叶斯网络、支持向量机。

以上几种算法在《机器学习实战》有介绍及实例。见-MachineLearning文件夹有相关笔记，还在学习更新中。

##### ③回归分析

建立模型研究变量之间相互关系的密切程度、结构状态及进行模型预测的一种工具。

主要回归模型有：

- 线性回归（一条直线拟合两个参数的关系）
- 非线性回归（某种曲线拟合参数关系）
- logistic回归（概率性非线性回归）
- 岭回归（目前暂未接触过，后续补充）
- 主成分回归（由主成分分析思想提出来）

介绍了logistic回归模型的原理。（机器学习实战中以python实现了该算法，此处用sklearn库进行处理）

书中记录实例用sklearn库对某银行在降低贷款拖欠率的数据进行logistic回归建模。

##### ④决策树

构造决策树的核心问题是在每一步如何选择适当的属性对样本做拆分。基于“分类讨论、逐步细化”思想的分类模型。

常用决策树算法：

- ID3算法（最大信息增益值）
- C4.5算法
- CART算法

介绍了ID3算法的原理（机器学习实战决策树章节中以Python实现了该算法，此处用sklearn库进行处理）

书中记录实例用sklearn库构建模型分析天气、周末、促销活动对销量的影响。

##### ⑤人工神经网络   （了解不多，后续补充。）  

模拟生物神经网络进行信息处理的一种数学模型。具有强大的拟合能力，可以用于拟合、分类等。  

人工神经元模型：

![没了。](https://github.com/doordiey/Python_data_analysis/tree/master/image/5--1.png)

人工神经网络的几个主要概念。

  一个神经网络包括了三层，分别为输入层（就是我们已有的信息），隐藏层（学习在此进行）和输出层（结果的输出）。每一层可能包括多个神经元就像我们大脑一样多个细胞负责一个部分的工作，相互配合。（神经元就是人工神经网络操作的基本信息处理单位。

  人工神经网络的学习被称为训练，指的是神经网络在收到外部环境的刺激下调整神经网络的参数，使神经网络以一种新的方式对外部环境作处翻译的一个过程。下图为学习规则示意图。

![没了。](https://github.com/doordiey/Python_data_analysis/tree/master/image/5--2.png)

在上图模型中显示的激活函数由多种类型，如阈值函数、分段线性函数、Relu函数。

keras可快速搭建神经网络。文档：[快速](https://keras-cn.readthedocs.io/en/latest/)

关于运用：

书中提到用Keras库建立神经网络由3个输入节点、10个隐藏节点、1个输出节点预测销量高低。（情景同上一个，就天气等情况预测销量高低。）

##### ⑥分类与预测算法评价

衡量那些分类与预测算法效果的各项指标：

- 绝对误差与相对误差
- 平均绝对误差
- 均方误差
- 均方根误差
- 平均绝对百分误差
- Kappa统计
- 识别准确度
- 识别精确率
- 反馈率
- ROC曲线
- 混淆矩阵

关于Kappa统计：

Kappa统计使比较两个或多个观测者对同一事物，或 观测者对同一事物的两次或多次观测结果是否一致，以由于机遇造成的一致性和实际观测的一致性之间的差别大小作为评价基础的统计指标。（取值位于[-1,1]之间。越大说明一致性越好。）

关于准确度、精确率、反馈率：

举例说明：

TP:将正的预测为正 4

FN:将正的预测为负 3

FP:将负的预测为正  2

TN:将负的预测为负  1

则：

准确率为：(4+1）/10 = 0.5

精确率为：4/（4+2） = 2/3

召回率为：4/(4+3)  =4/7

  关于ROC曲线：

中文翻译过来的话全称为：受试者工作特征曲线。可为选定临界值给出定量提示，反映分类器正确分类的统计概率，曲线下的积分面积大小与每种方法优劣密切相关。其值越接近1说明该算法效果越好。

关于混淆曲线：

描绘样本数据的真实属性与识别结果类型之间的关系。

### 聚类分析

在没有给定划分类别的情况下，根据数据相似度进行样本分组的一种方法。划分原则为:组内距离最小化而组间距离最大化。（就是说：是一组的在一起，不是一组的离远点。）

##### ①常用聚类分析算法

常用方法：

划分方法、层次分析方法、基于密度的方法、基于网络的方法、基于模型的方法。

常用算法：

K-Means、K-中心点、系统聚类

实例：

K-Means聚类算法分析消费行为特征数据。（依然是用了sklearn库应用了KMeans的函数。



